@using OMS.UI.Areas.Configuration.ViewModels
@model List<ProjectStatusVM>


<div class="modal fade" id="mdlProjectStatusShow" style="">
	<div class="modal-dialog modal-xl" id="PlaceHolderHere">
	</div>
</div>

<div class="card">
	<div class="card-header">
		<div class="row align-items-center">
			<div class="row align-items-center">
				<div class="col-lg-6">
					<h4 class="card-title">Project Status Index</h4>
				</div>
				<div class="col-lg-6 text-end">
					<button type="button" class="btn btn-de-primary" data-toggle="ajax-modal"
							data-target="#mdlProjectStatusShow" data-url="@Url.Action("Create")">
						<i class="fas fa-plus me-2"></i>Add Project Status
					</button>
				</div>
			</div>
			<!--end col-->

		</div>  <!--end row-->
	</div><!--end card-header-->
	<div class="card-body">
		<form action="Create">
		<div class="modal fade" id="Statusadd" tabindex="-1" aria-labelledby="addStatusLabel" aria-hidden="true" style="display: none;">
			<div class="modal-dialog ">
				<div class="modal-content">
					<div class="modal-header">
						<h6 class="modal-title m-0" id="addStatusLabel">Project Status Setup</h6>
					</div>
					<div class="modal-body">
						<div class="row">
							<div class="col-lg-12 g-2">
								<div class="mb-3 text-start">
									<label for="example-text-input">
										Name <span class="f-14 mr-1 text-danger">*</span>

									</label>
									<input class="form-control" name="Name" type="text" value="" id="example-text-input">
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-lg-6 g-2">
								<div class="mb-3 text-start">
									<label for="example-text-input">
										Label Color
										<span class="f-14 mr-1 text-danger">*</span>
									</label>
									<input type="color" name="ColorCode" class="form-control form-control-color" id="exampleColorInput" value="#0b51b7" title="Choose your color">

								</div>
							</div>
							<div class="col-lg-6 g-2">
								<div class="mb-3 text-start">
									<label for="example-text-input">
										Status

									</label><br />
										<div class="form-check form-switch form-switch-success">
											<input class="form-check-input" name="Status" type="checkbox" id="customSwitchRMSuccess">
										</div>
								</div>
							</div>
						</div>

					</div><!--end card-body-->
					<div class="modal-footer">

						<div class="row">
							<div class="col-lg-12 text-end">
								<button type="button" class="btn btn-sm btn-de-danger me-2" data-bs-dismiss="modal"><i class="mdi mdi-window-close me-2"></i>Close</button>
								<button type="button" class="btn btn-sm btn-de-primary "><i class="mdi mdi-check-all me-2 "></i>Create</button>
							</div>
						</div>

					</div><!--end modal-footer-->
				</div><!--end modal-content-->
			</div><!--end modal-dialog-->
		</div><!--end modal-->
		<!--status Setting Modal end-->
		</form>
		<div class="table-responsive">
			<table class="table mb-0">
				<thead class="thead-light">
					<tr>
						@* <th class="d-none">@Html.DisplayNameFor(m => m.)</th> *@
						<th>#</th>
						<th>Name</th>
						<th>Default Status</th>
						<th>Action</th>
					</tr><!--end tr-->
				</thead>

				<tbody>
					@for (var i = 0; i < Model.Count(); i++)
					{
						<tr>
							<td class="d-none">@Html.DisplayNameFor(m => Model[i].Id)</td>
							<td>@(i + 1)</td>
							<td><span><i class="bi bi-dot bg-info ps-2 pe-2  rounded-circle me-2"></i></span>@Model[i].Name</td>
							<td>
								<div class="form-check default_status" data-status-id="@Model[i].Id">
									<input class="form-check-input" type="radio" name="IsDefaultStatus" id="projRadios1" value="@Model[i].IsDefaultStatus" @(Model[i].IsDefaultStatus ? "checked" : "")>
									<label class="form-check-label" for="projRadios1">
									</label>
								</div>
							</td>
							<td>
								<button type="button" class="custombuttonaslink" data-toggle="ajax-modal"
										data-bs-target="#mdlProjectStatusShow" data-url="@Url.Action($"EditProjectStatus/{@Model[i].Id}")">
									<i class="las la-pen text-secondary font-16"></i>
								</button>
								@if(!Model[i].IsDefaultStatus){
								<a id="deleteBL" name="Id" href="#" class="ms-2"
									   data-target="" data-url="@Url.Action($"DeleteProjectStatus/{@Model[i].Id}")">
									<i class="las la-trash-alt text-secondary font-16"></i>
								</a>
								}
							</td>

							@* <td>
								<a href="#" data-bs-toggle="modal" data-bs-target="#Status"><i class="las la-pen text-secondary font-16"></i></a>
								<a href="#" class="ms-2" onclick="executeExample('warningConfirm')" data-toggle="tooltip" data-placement="top" title="Delete"><i class="las la-trash-alt text-secondary font-16"></i></a>
							</td> *@
						</tr><!--end tr-->
					}
				</tbody>
			</table>
		</div>
	</div><!--end card-body-->
</div><!--end card-->

<script type="text/javascript">
		$('body').on('click', '.default_status', function () {
			const swalWithBootstrapButtons = Swal.mixin({
			  customClass: {
				 confirmButton: "btn btn-de-primary",
				 cancelButton: "btn btn-de-danger me-2"
			  },
			  buttonsStyling: false
		   });
		var statusID = $(this).data('status-id');
		$("#divBlocker").removeClass("d-none").addClass("screenblocker");
		var currentUrl = window.location.href;
		currentUrl = currentUrl.substring(0, currentUrl.lastIndexOf("/") + 1);
		var url = currentUrl + "DefaultStatusUpdate";
			  var sendData = "Id=" + statusID + "";

		  $.post(url, sendData).done(function (data, status) {
				 $("#divBlocker").addClass("d-none").removeClass("screenblocker");
				 if (status == "success") {
							 swalWithBootstrapButtons.fire({ title: "Updated!",
		 text: "Updated successfully!",
		 icon: "success",
			  allowOutsideClick: false}).then(okay => {
		   if (okay) {
			location.reload();
		  }
		});

				 }
				 else{
					@*  swalWithBootstrapButtons.fire({
				 title: "Error Occured",
				 text: "Error Occured while Data deletion",
				 icon: "error",
					allowOutsideClick: false
				 }); *@
				 }
			  })
	});
</script>